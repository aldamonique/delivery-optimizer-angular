<div class="top-bar">
  <div class="metric"><mat-icon>attach_money</mat-icon> Total Cost: {{ data?.best_total_cost }}</div>
  <div class="metric"><mat-icon>timeline</mat-icon> Generation: {{ data?.found_at_generation }}</div>

  <!-- New: Route Summary -->
  <div class="metric" *ngFor="let route of data?.route_details; let i = index">
    <mat-icon>route</mat-icon> 
    <span>R{{ i + 1 }}: {{ route.distance_km }} km → {{ route.path.join(',') }}</span>
  </div>
</div>




<div class="dashboard-container">
  <aside class="sidebar">
    <mat-nav-list>
      <a mat-list-item href="#" class="active-link">
        <mat-icon>home</mat-icon> Home
      </a>
      <a mat-list-item href="#">
        <mat-icon>folder_open</mat-icon>Generate new random clients
      </a>
      <a mat-list-item href="#"><mat-icon>check_box</mat-icon> Tarefas</a>
      <a mat-list-item href="/teste"><mat-icon>group</mat-icon> Equipa</a>
      <a mat-list-item href="#"><mat-icon>settings</mat-icon> Definições</a>
    </mat-nav-list>

    <div class="upgrade-card">
      <h4>Upgrade para Pro</h4>
      <p>Obtenha 1 mês grátis e desbloqueie mais funcionalidades.</p>
      <button mat-flat-button color="primary">Upgrade</button>
    </div>
  </aside>





  <div class="main-content">
    <div *ngIf="isLoading" class="loading-spinner">
      <p>Fetching the best solution...</p>
      <!--<mat-spinner color="primary" diameter="100"></mat-spinner>-->
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>


    <div *ngIf="!isLoading && data" class="content-wrapper">
      <h2 *ngIf="errorMessage" class="error-message">{{ errorMessage }}</h2>

    <div class="container-button">
      <button mat-flat-button color="primary" class="stylish-button" (click)="getGenerateNewCustomers()">
        <mat-icon>autorenew</mat-icon>
        Generate new random clients
      </button>
    </div>

    


      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>Optmized Delivery Plan</mat-card-title>
          <mat-card-subtitle>Summary of the found solution</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content class="summary-content">
          <div>
            <span>Total Cost</span>
            <p>{{ data.best_total_cost | currency : "BRL" }}</p>
          </div>
          <div>
            <span>Generation Found</span>
            <p>{{ data.found_at_generation }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-content>
          <img class="graph-container"
            [src]="getSanitizedImageUrl(data!.solution_image_base64)"
            alt="Gráfico da melhor rota encontrada"
          />
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
